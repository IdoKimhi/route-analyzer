{% extends "base.html" %}
{% block content %}

<h1>Setup</h1>

<div class="card">
  <h2>Add route</h2>
  <form method="post" class="form">
    <div class="row">
      <div>
        <label>Route name (optional)</label>
        <input name="name" placeholder="Home to Work" />
      </div>
      <div class="checkboxLine">
        <label class="inline">
          <input type="checkbox" name="enabled" checked />
          Enabled
        </label>
      </div>
    </div>

    <div class="row">
      <div>
        <label>Start latitude</label>
        <input name="start_lat" required />
      </div>
      <div>
        <label>Start longitude</label>
        <input name="start_lng" required />
      </div>
    </div>

    <div class="row">
      <div>
        <label>End latitude</label>
        <input name="end_lat" required />
      </div>
      <div>
        <label>End longitude</label>
        <input name="end_lng" required />
      </div>
    </div>

    <div class="row">
      <div>
        <label>Waze region</label>
        <input name="waze_region" placeholder="IL" value="IL" />
        <div class="hint">Typical: IL, EU, US</div>
      </div>
      <div></div>
    </div>

    <button type="submit">Add</button>
  </form>
</div>

<div class="card">
  <h2>Routes</h2>

  {% if routes %}
    <div class="tableWrap">
      <table>
        <thead>
          <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Enabled</th>
            <th>Start</th>
            <th>End</th>
            <th>Region</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for r in routes %}
          <tr>
            <td class="mono">{{ r.id }}</td>
            <td>{{ r.name }}</td>
            <td>{{ "yes" if r.enabled else "no" }}</td>
            <td class="mono">{{ r.start_lat }}, {{ r.start_lng }}</td>
            <td class="mono">{{ r.end_lat }}, {{ r.end_lng }}</td>
            <td class="mono">{{ r.waze_region }}</td>
            <td>
              <form method="post" action="/routes/{{ r.id }}/toggle" style="display:inline">
                <button type="submit">{{ "Disable" if r.enabled else "Enable" }}</button>
              </form>
              <form method="post" action="/routes/{{ r.id }}/delete" style="display:inline" onsubmit="return confirm('Delete route {{ r.id }}?');">
                <button type="submit">Delete</button>
              </form>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  {% else %}
    <div class="hint">No routes yet.</div>
  {% endif %}
</div>

{% endblock %}
